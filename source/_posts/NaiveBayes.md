---
title: NaiveBayes
date: 2018-09-27 17:29:07
mathjax: true
tags: ML
---


## 公式学习和证明

#### 全概率公式

 $B_1, B_2,..., B_i$是事件$E$的样本空间$\Omega$ 的划分，$A$为$E$的事件，则
$$
 P(A) = \sum_{i=1}^n P(B_i)P(A|B_i)  \quad (1)
$$

称为全概率公式


**证明**：
$A = A\Omega  = A(B_1\cup B_2\cup ...\cup B_i)$ 因为
$P(A \cup B) = P(A) + P(B) - P(AB)$
且$B_iB_j=\varnothing $
$$
 P(A) = \sum_{i =1}^n P(AB_i) \quad (2)
$$

再由条件概率公式$P(A|B)$ =
$$
 P(A|B) = \dfrac{P(AB)}{P(B)} \quad (3)
$$
把公式3带到公式2中，证明完毕。

##### 例子
 
>某人坐火车，汽车，轮船，飞机的概率分别是0.3，0.2，0.1，0.4，如果乘坐火车，汽车，轮船迟到的概率分别是1/4，1/3，1/12，乘坐飞机不会迟到。求他迟到的概率

**解**：A为表示事件“迟到”，$B_1,B_2,B_3,B_4$分别表示坐火车，汽车，轮船，飞机等事件，已知$P(B_1)=0.3,P(B_2)=0.2, P(B_3)=0.1, P(B_4)=0.4,  P(A|B_1) = 1/4,P(A|B_2) = 1/3,P(A|B_3) = 1/12,P(A|B_4) = 0$
条件都已知，则直接根据全概率公式算出$P(A)$



#### 贝叶斯公式

试验$E$的样本空间为$\Omega$ ，$A$为$E$的事件，$B_1,B_2,...,B_n$为$\Omega$的一个划分，$P(A) > 0, P(B_i) > 0, i = 0,1,..,n$
$$
 P(B_i|A) = \dfrac{P(B_i)P(A|B_i)} {\sum_{j = 1}^nP(B_j)P(A|B_j)},\, i=1,2...n \quad (4)
$$

**证明**：
由条件概率和乘法公式得

$$
 P(B_i|A) = \dfrac{P(AB_i)}{P(A)} = \dfrac{P(Bi)P(A|B_i)}{P(A)}  \quad (5)
$$
$P(A)$由全概率公式可以计算出来，再代入上式，证明完毕

## 朴素贝叶斯
输入空间：$\chi\subseteq R^n$是$n$ 维向量的集合,输出空间标记集合$Y = \{c_1,c_2,...,c_k \} $

**先验概率分布:**

$$
P(Y=c_k), \quad k=1,2,...,K \quad (6)
$$


**条件概率分布:**

$$
P(X=x|Y=c_k) = P(X^{(1)} = x^{(1)},..,X^{(n)}=x^{(n)}|Y=c_k)  \quad (7)
$$
朴素贝叶斯会假设每个特征都是独立的，由于是个较强的假设，所以朴素贝叶斯由此得名。具体如下
$$
P(X=x|Y=c_k) = P(X^{(1)} = x^{(1)},..,X^{(n)}=x^{(n)}|Y=c_k)   =  \prod_{j = 1}^{n}P(X^{(n)} = x^{(n)}|Y = c_k)  \quad (8)
$$

根据贝叶斯公式得出后验概率
$$
P(Y=c_k|X=x)  = \frac{P(X=x|Y=c_k)P(Y=c_k)}{\sum_k P(X=x|Y=c_k)P(Y=c_k)}
$$
把公式3带，得

$$
P(Y=c_k|X=x) = \frac{P(Y=c_k)\prod_jP(X^{(j)}=x^{(j)})|P(Y=c_k)}{\sum_kP(Y=c_k)\prod_jP(X^{(j)}=x^{(j)}|Y=c_k)} \quad k=1,2,...K  \quad (9)
$$
式9中分母对所有的$c_k$都相同，对所有类别来说都是常数，式9的最大化就是分子的最大化

$$
arg \max_{c_k} P(Y=c_k)\prod_jP(X^{(j)}=x^{(j)})|P(Y=c_k)   \quad (10)
$$

##### 例子
$X^{(1)},X^{(2)}$为特征，取值的集合为$A_1 = \{1,2,3\}, A_2 = \{S,M,L\}$, $Y$为类标记，$Y\in  C = \{1,-1\}$,试用朴素贝叶斯分类器确定$x = \{2,S\}^{T}$的类标记$y$

  | |1| 2|3|4|5|6|7|8|9|10|11|12|13|14|15|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|$X^{(1)}$|1|1|1|1|1|2|2|2|2|2|3|3|3|3|3|
|$X^{(2)}$|S|M|M|S|S|S|M|M|L|L|L|M|M|L|L|
|$Y$|-1|-1|1|1|-1|-1|-1|1|1|1|1|1|1|1|-1|

**解**:
 由表得出 $ P(Y = 1) = \frac{9}{15}$   $ P(Y = -1) = \frac{6}{15} $
 
 $ P(X^{(1)} = 1 | Y = 1) =  \frac{2}{9}  \quad P(X^{(1)} = 2 | Y = 1) =  \frac{3}{9}  \quad P(X^{(1)} = 3 | Y = 1) =  \frac{4}{9}$
  
 $ P(X^{(2)} = S | Y = 1) =  \frac{1}{9}  \quad P(X^{(2)} = M | Y = 1) =  \frac{4}{9}  \quad P(X^{(2)} = L | Y = 1) =  \frac{4}{9}$
  
 $ P(X^{(1)} = 1 | Y = -1) =  \frac{3}{6}  \quad P(X^{(1)} = 2 | Y = -1) =  \frac{2}{6}  \quad P(X^{(1)} = 3 | Y = -1) =  \frac{1}{6}$
  
 $ P(X^{(2)} = S | Y = -1) =  \frac{3}{6}  \quad P(X^{(2)} = M | Y = -1) =  \frac{2}{6}  \quad P(X^{(2)} = L | Y = -1) =  \frac{1}{6}$
 对于给定的$x = \{2,S\}^{T}$计算：
 
 由朴素贝叶斯公式10得出

  $$P(Y = 1)P(X^{(1)} = 2 | Y = 1)P(X^{(2)} = S | Y = 1) = \frac{9}{15} *  \frac{3}{9}  *  \frac{1}{9} = \frac{1}{45} $$
 
  $$ P(Y = -1)P(X^{(1)} = 2 | Y = -1)P(X^{(2)} = S | Y = -1) = \frac{6}{15} *  \frac{2}{6}  *  \frac{3}{6} = \frac{1}{15} $$
  
  $\frac{1}{15} > \frac{1}{45}$,则$y$= -1