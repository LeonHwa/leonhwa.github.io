---
title: æŸå¤±å‡½æ•°å’Œä»£ä»·å‡½æ•°
date: 2019-09-21 23:32:57
tags: DL
---

> $\hat{y}$: è®­ç»ƒé›†çš„é¢„æµ‹å€¼ 
>
> $y$: è®­ç»ƒé›†çš„å®é™…å€¼ 
>
> ä¸Šæ ‡ (ğ‘–)æ¥æŒ‡æ˜ æ•°æ®è¡¨ç¤º ğ‘¥æˆ–è€… ğ‘¦æˆ–è€… ğ‘§æˆ–è€…å…¶ä»–æ•°æ®çš„ç¬¬ ğ‘–ä¸ªè®­æ ·æœ¬ï¼Œå¦‚$x^{(i)},z^{(i)} $

### æŸå¤±å‡½æ•°ï¼ˆè¯¯å·®å‡½æ•°ï¼‰

ç”¨æ¥è¡¡é‡ç®—æ³•è¿è¡Œæƒ…å†µï¼Œå¯ä»¥è¡¨ç¤ºä¸º$\text { Loss function: } L(\hat{y}, y)â€‹$

**å¹³æ–¹å·®æŸå¤±å‡½æ•°(quadratic)**ï¼š
$L=\frac{(y-a)^{2}}{2}â€‹$

ä¸€èˆ¬ç”¨äºçº¿æ€§å›å½’



**cross-entropy**:  

$ L = -y \ln a - (1-y) \ln (1-a)â€‹$

ç”¨äºé€»è¾‘å›å½’ï¼Œä»¥åŠç¥ç»ç½‘ç»œä¸­ï¼ˆåºŸè¯ï¼‰



### ä»£ä»·å‡½æ•°

æŸå¤±å‡½æ•°åªé€‚ç”¨äºçš„å•ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œè€Œä»£ä»·å‡½æ•°æ˜¯å‚æ•°çš„æ€»ä»£ä»·ï¼Œè¡¡é‡ç®—æ³•åœ¨å…¨éƒ¨è®­ç»ƒæ ·æœ¬ä¸Šçš„è¡¨ç°

å¯¹äºcross-entropyçš„ä»£ä»·å‡½æ•°å¯è¡¨ç¤ºä¸º

$$J(w,b) = \frac{1}{m} \sum_{i=1}^{m}  L (\hat{y}^{(i)},  y^{(i)}) = \frac{1}{m} \sum_{i = 1}^{m}\left (-y^{(i)} log\hat{y}^{(i)} - (1 - y^{(i)} ) log(1- \hat{y}^{(i)}) \right)â€‹$$

#### ä»£ä»·å‡½æ•°åå¯¼æ•°

å·²çŸ¥

$z= w x+ b \tag{1}â€‹$

$a = g(z) =\frac{1}{1+e^{-z}} \tag{2}â€‹$

$$g^{\prime}(z) = g(z)(1-g(z)) \tag{3}â€‹$$

$ L = -y \ln a - (1-y) \ln (1-a) \tag{4}â€‹$

å¯¹æŸå¤±å‡½æ•°wæ±‚åå¯¼

$$ \begin{aligned}  \frac{\partial L(w,b)}{\partial w}  &=  -\frac{y}{a}a' + \frac{1-y}{1-a} a'  \\ & = \frac{a- y}{a(1-a)} a'\end{aligned} \tag{5}â€‹$$

åˆå› ä¸º

$$\begin{aligned}  \frac{\partial a}{\partial w} &= \frac{\partial a}{\partial z}  \frac{\partial z}{\partial w}   \\ &= a(1-a)  \end{aligned} \tag{6}â€‹$$

å¸¦å…¥ä¸Šå¼å¾—

$ \frac{\partial L(w,b)}{\partial w}  = a - y \tag{7} â€‹$

å¾—å‡ºä»£ä»·å‡½æ•°wåå¯¼æ•°ä¸º

$$\frac{\partial J(w, b)}{\partial w} = \frac{1}{m} \sum_{i=1}^m (a^i - y^i)x^i \tag{8}â€‹$$



åŒç†å¾—ä»£ä»·å‡½æ•°båå¯¼æ•°ä¸º

$$\frac{\partial J(w, b)}{\partial b} = \frac{1}{m} \sum_{i=1}^m (a^i - y^i) \tag{9}$$

### ç–‘æƒ‘

ä¸ºä»€ä¹ˆé€»è¾‘å›å½’çš„æŸå¤±å‡½æ•°çš„çš„è¡¨è¾¾å¼æ˜¯è¿™æ ·å‘¢ï¼Ÿ æœ‰å¯¹æ•°ï¼Œåˆæœ‰1-yï¼Œåˆå¸¦æœ‰è´Ÿå·

å¯¹äº$Sâ€‹$å‹æ¿€æ´»å‡½æ•° $\sigma(z) = \sigma(w^T x + b) = \frac{1}{1+e{-z}}â€‹$ï¼Œçº¦å®š$\hat{y} = p(y = 1 |x)â€‹$ ï¼Œå³$\hat{y} â€‹$Â è¡¨ç¤ºç»™å®šè®­ç»ƒæ ·æœ¬$xâ€‹$æ¡ä»¶ä¸‹$yâ€‹$äº1çš„æ¦‚ç‡ 

å› æ­¤ï¼Œå¦‚æœ$\hat{y}$ ä»£è¡¨$y = 1$çš„æ¦‚ç‡ï¼Œé‚£ä¹ˆ$1 - \hat{y}$å°±æ˜¯$y = 0$çš„æ¦‚ç‡ã€‚

$\begin{array}{ll}{\text { If } \quad y=1 :} & {p(y | x)=\hat{y}} \\ {\text { If } \quad y=0 :} & {p(y | x)=1-\hat{y}}\end{array}$

ä¸Šé¢ä¸¤å¼åˆå¹¶å¯å¾—å‡º$p(y|x) $å®Œæ•´å®šä¹‰

$$p(y|x) = \hat{y}^y (1 - \hat{y})^{(1-y)}$$

ç”±äº$log$ å‡½æ•°æ˜¯ä¸¥æ ¼å•è°ƒé€’å¢çš„å‡½æ•°ï¼Œæœ€å¤§åŒ–$log(p(y|x))$ç­‰ä»·äºæœ€å¤§åŒ–$p(y|x) $å¹¶ä¸”åœ°è®¡ç®—$p(y|x) $ çš„$log$å¯¹æ•°ï¼Œå³è®¡ç®—$log( \hat{y}^y (1 - \hat{y})^{(1-y)})$(å…¶å®å°±æ˜¯å°†$p(y|x) $ä»£å…¥)ï¼Œé€šè¿‡å¯¹æ•°å‡½æ•°åŒ–ç®€ä¸ºï¼š

$$ylog(\hat{y}^y)  +(1-y) log(1 - \hat{y})$$



é€»è¾‘å›å½’æŸå¤±å‡½æ•°å‰é¢æœ‰è´Ÿå·çš„åŸå› æ˜¯ï¼šå½“è®­ç»ƒå­¦ä¹ ç®—æ³•æ—¶éœ€è¦ç®—æ³•è¾“å‡ºå€¼çš„æ¦‚ç‡æ˜¯æœ€å¤§çš„ï¼ˆä»¥æœ€å¤§çš„æ¦‚ç‡é¢„æµ‹è¿™ä¸ªå€¼ï¼‰ï¼Œç„¶è€Œåœ¨é€»è¾‘å›å½’ä¸­æˆ‘ä»¬éœ€è¦æœ€å°åŒ–æŸå¤±å‡½æ•°ï¼Œå› æ­¤æœ€å°åŒ–æŸå¤±å‡½æ•°ä¸æœ€å¤§åŒ–æ¡ä»¶æ¦‚ç‡çš„å¯¹æ•°ğ‘™ğ‘œğ‘”(ğ‘(ğ‘¦|ğ‘¥)) å…³è”èµ·æ¥äº†ï¼Œå› æ­¤è¿™å°±æ˜¯å•ä¸ªè®­ç»ƒæ ·æœ¬çš„æŸå¤±å‡½æ•°è¡¨è¾¾å¼ã€‚

$$-ylog(\hat{y}^y)  -(1-y) log(1 - \hat{y})$$



æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Ÿ